<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Ruby Styling</title>
<meta name="description" content="How to use CSS styling to support ruby text for Asian languages." />
<script type="text/javascript">
var f = { }

// AUTHORS should fill in these assignments:
f.directory = 'articles/ruby'+'/'; // the path to this file, not including /International or the file name
f.filename = 'styling'; // the file name WITHOUT extensions
f.authors = 'Richard Ishida, W3C'; // author(s) and affiliations
f.previousauthors = ''; // as above
f.modifiers = ''; // people making substantive changes, and their affiliation
f.searchString = 'article-ruby-styling'; // blog search string - usually the filename without extensions
f.firstPubDate = '2016-02-04'; // date of the first publication of the document (after review)
f.lastSubstUpdate = { date:'2016-02-04', time:'11:23'}  // date and time of latest substantive changes to this document
f.status = 'draft';  // should be one of draft, review, published, notreviewed or obsolete
f.path = '../../' // what you need to prepend to a URL to get to the /International directory 

// AUTHORS AND TRANSLATORS should fill in these assignments:
f.thisVersion = { date:'2016-02-04', time:'11:23'} // date and time of latest edits to this document/translation
f.contributors = ''; // people providing useful contributions or feedback during review or at other times
// also make sure that the lang attribute on the html tag is correct!

// TRANSLATORS should fill in these assignments:
f.translators = 'xxxNAME, ORG'; // translator(s) and their affiliation - a elements allowed, but use double quotes for attributes

f.breadcrumb = 'markup';

f.additionalLinks = ''
</script>
<script type="text/javascript" src="styling-data/translations.js"> </script>
<script type="text/javascript" src="../../javascript/doc-structure/article-dt.js"> </script>
<script type="text/javascript" src="../../javascript/boilerplate-text/boilerplate-en.js"></script><!--TRANSLATORS must change -en to the subtag for their language!-->
<script type="text/javascript" src="../../javascript/doc-structure/article.js"> </script>
<script type="text/javascript" src="../../javascript/articletoc-html5.js"></script>
<link rel="stylesheet" href="../../style/article-2016.css" type="text/css" />
<link rel="stylesheet" href="local.css" type="text/css" />

<link rel="copyright" href="#copyright"/>
<!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<style>
.rubyExample { font-size: 50px; font-family: "ms mincho"; margin: 0; }
.el { color: #D61B1B; font-size: 100%; font-weight: 400; margin: 0 2px; }
.nowrap { white-space:nowrap; }
ruby { font-size: 50px; color: rgb(102, 102, 102); font-family: "ms mincho", stsong, 'lisong pro';  }
rt {}
rb {}
rtc {}

.codeExample { margin:0 0 0 7.5%; width: 60%; }
.codeExample figure { margin:0; }
.sidebarNote { margin: .5em 1em 0 2em; }
.sidebarNote aside { margin: 0; float: none; width: 24%; }
</style>
<!-- styling for alignment examples:
ruby { font-size: 55px; font-family: "ms mincho", stsong, 'lisong pro'; color: #333; }
-->
<script>
function highlightCode () {
	var examples = document.querySelectorAll('figure.example')
	for (var i=0;i<examples.length;i++) {
		var re = /&lt;([^&]+)&gt;/
		var content = examples[i].innerHTML
		out = content.replace(/&lt;([^&]+)&gt;/g,'<span class="el">&lt;$1&gt;</span>')
		examples[i].innerHTML = out
		}
	}
</script>
</head>

<body>
<header>
  <nav id="mainNavigation"></nav><script>document.getElementById('mainNavigation').innerHTML = mainNavigation</script>
  
  <h1>Ruby Styling (draft!)</h1>
</header>


<section>
  <div id="audience">
    <p><span id="intendedAudience" class="leadin">Intended audience:</span> 
    XHTML/HTML coders (using editors or scripting), script developers (PHP, JSP, etc.), CSS coders, and
      anyone who wants to know how to use ruby annotations. </p>
    <div id="updateInfo"></div><script>document.getElementById('updateInfo').innerHTML = g.updated</script>
    </div>
    
  <p>Ruby is the name given to the small annotations in Japanese and Chinese content that are rendered alongside base text, usually to provide a pronunciation guide, but sometimes to provide other information. We will assume that you are familiar with ruby, and how you want it to look. (If not,  <a class="print" href="https://www.w3.org/International/articles/ruby/">see the short overview</a> of how ruby works.)</p>
  <p>This article will only discuss how to use CSS <em>styling</em> to affect the rendering of ruby content. For information about how to create the markup needed to support ruby, see <a href="https://www.w3.org/International/articles/ruby/markup" class="print">Ruby Markup</a>.</p>
    <aside class="insideimplnote">
  <p class="impl"> While the main body of the text explains how to achieve the result you want using CSS, as described in the editor's draft of the CSS Ruby Layout module, you'll find boxes like this that explain some of the associated caveats and issues, as well as identifying which features that are not supported by one browser or another.</p>
    </aside>
  <p>The editor's draft of the <a href="https://drafts.csswg.org/css-ruby-1/">CSS Ruby Layout Module Level 1</a> provides a number of initial properties for describing the placement of ruby text in relation to the base text. Later versions of the spec are expected to add more properties. Note that this specification is not yet finalized, so this page will aim to give you an idea of what to expect if it is fully implemented, as well as describing what is currently supported.</p>
  <p>We won't simply reproduce the spec itself here, but rather provide guidance about how content authors can achieve key techniques. We will assume that your ruby content is marked up appropriately, so that the mapping between ruby bases and ruby text is correct.</p>
</section>


<section>
  <h2 id="ruby_position"><a href="#ruby_position">Positioning ruby relative to the base text</a></h2>
    <p> This section looks at how you make the ruby text appear above, below or to the side of the ruby base
      text.</p>
    <section>
    <h3 id="position_over"><a href="#position_over">Positioning ruby text 'over' the base</a></h3>
    <p>By 'over' we mean above horizontal text and to the right of vertical  text.</p>
    <figure>
    <p><img style="margin-right: 30%; vertical-align:top;" src="styling-data/ruby_position_over_hor.png" alt="Horizontal ruby for 水芝居(みずしばい)"><img src="styling-data/ruby_position_over_ver.png" alt="Vertical ruby for 水芝居(みずしばい)"></p>
    </figure>
    <br  style="clear:both;"/>

    <p>This is the default behavior, and you can expect browsers to produce this without CSS. </p>
    <p>If you need to place the ruby explicitly in this position, use:</p>
    
    
<div class="annotatedCode">
<div class="acFigure">
    <figure class="example" lang="ja">
      <p>ruby { ruby-position: over; }</p>
     <div class="demolink"><a href="styling-data/eg_ruby_position_over" target="text">See live demo.</a></div>
   </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/><img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/><br>
    Works  well because this is the default rendering for ruby. <br>
    <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_position_over">See test results for major browsers</a>.</p>
</aside>
</div>
</div>

    
    <p>To position the ruby text below horizontal base text or to the left of vertical text, use <code>ruby-position: under</code>.</p>
  </section>
    
    <section>
    <h3 id="position_under"><a href="#position_under">Positioning ruby text 'under' the base</a></h3>
    <p>By 'under' we mean below horizontal text and to the left of vertical CJK text.</p>
    <figure>
    <p><img style="margin-right: 30%; vertical-align:top;" src="styling-data/ruby_position_under_hor.png" alt="Horizontal ruby for  水芝居(みずしばい)"><img src="styling-data/ruby_position_under_ver.png" alt="Vertical ruby for  水芝居(みずしばい)"></p>
   </figure>
   <p>This position is often used in Japanese for semantic information (as opposed to phonetic labelling). It is also used sometimes for pinyin annotations in Chinese. Here is an example from the moedict dictionary.</p>
    <figure>
    <p><img src="styling-data/pinyin-under.png" width="267" height="190" alt=""/></p>
    </figure>
    <p>To produce this effect, use: </p>


<div class="annotatedCode">
<div class="acFigure">
   <figure class="example" lang="ja">
      <p>ruby { ruby-position: under; }</p>
    <div class="demolink"><a href="styling-data/eg_ruby_position_under" target="text">See live demo.</a></div>
  </figure>
</div>
<div class="acNote">
  <aside class="simpleimplnote">
  <p><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/> <br>
    <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> works only if you also use <code class="kw" translate="no">-webkit-ruby-position: after</code>.<br>
    <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/><br>
    <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_position_under">See test results for major browsers</a>.</p>
</aside>
</div>
</div>


    </section>
    
    <section>
    <h3 id="bopomofo_position"><a href="#bopomofo_position">Positioning bopomofo ruby</a></h3>
    <p>In Traditional Chinese, <a href="https://en.wikipedia.org/wiki/Bopomofo">bopomofo</a> (zhùyīn fúhào) ruby appears to the right of the base character, whether the text is set horizontally or vertically. Furthermore, the bopomofo annotation is always set vertically and the tone marks (apart from the light tone) are displayed in an additional column to the right of the bopomofo characters.</p>
    <figure>
    <p><img style="margin-right: 30%; vertical-align:top;" src="styling-data/bopomofo_hor.png" alt="Horizontal ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"><img src="styling-data/bopomofo_ver.png" alt="Vertical ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"></p>
      <!--p lang="zh-TW" style="float:left;margin-right: 5em;"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt>ㄋㄠˇ</rt></ruby></p>
      <p lang="zh-TW"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt style="font-size:30%;">ㄋㄠˇ</rt></ruby></p-->
   </figure>
    <p>What you  have to do in CSS is indicate that this will be bopomofo ruby, so that the annotation doesn't appear 'over' or 'under' the base text. To do that, you need the <code class="kw" translate="no">inter-character</code> value of <code class="kw" translate="no">ruby-position</code>.</p>
    <p>The vertical placement for the bopomofo and the relative position of the tone characters within the invisible column to the right of the Han base character rely on the browser, or possibly font information. You don't need to specify anything more in CSS. </p>
 
 <div class="annotatedCode">
 <div class="acFigure">
   <figure class="example" lang="ja">
      <p>ruby { ruby-position: inter-character; }</p>
      <div class="demolink"><a href="styling-data/eg_bopomofo" target="text">See live demo.</a></div>
    </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/><br>
    Very simple annotations can look ok in vertical text, because of the default vertical layout, but as soon as tone marks are added things look a mess.<br>
    <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_position_inter">See test results for major browsers</a>.</p>
</aside>
</div>
</div>

    </section>
    
    <section>
    <h3 id="double_position"><a href="#double_position">Positioning  double-sided ruby</a></h3>
      <p>Occasionally, it is necessary to associate more than one annotations with the same base text. In this case, you need to specify which annotation goes where.</p>
    <figure>
    <p><img src="styling-data/double_mono.png" alt="Horizontal ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"></p>
      <!--p lang="zh-TW" style="float:left;margin-right: 5em;"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt>ㄋㄠˇ</rt></ruby></p>
      <p lang="zh-TW"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt style="font-size:30%;">ㄋㄠˇ</rt></ruby></p-->
   </figure>

      <p>This is complicated a little by the fact that there are two possible ways to create markup for double-sided ruby (see the <a href="markup">Ruby Markup</a> article for more details).</p>
      <p>If you use the 'tabular' model of markup, the styling is reasonably straightforward and involves setting <code class="kw" translate="no">ruby-position</code> on the appropriate <code class="kw" translate="no">rtc</code> element. Given markup such as the following:</p>
      <div class="sidenoteGroup">
      <figure class="example" lang="ja">
        <p>&lt;ruby&gt;<br>
        &lt;rb&gt;東&lt;/rb&gt;&lt;rb&gt;南&lt;/rb&gt;<br>
        &lt;rt&gt;とう&lt;/rt&gt;&lt;rt&gt;なん&lt;/rt&gt;<br>
        &lt;rtc&gt;&lt;rt&gt;tou&lt;/rt&gt;&lt;rt&gt;nan&lt;/rt&gt;&lt;/rtc&gt;<br>
        &lt;/ruby&gt;の方角</p>
      </figure>
      <aside class="sideinfonote">
        <p class="warning">To make the examples of markup easier to read, we have split the <code class="kw" translate="no">ruby</code> element components onto several lines. In theory, this should work fine. However, in practise, browers may add unwanted spaces to the rendered text. Therefore you should keep all the markup on a single line.</p></aside>
      </div>
      <p>you could use CSS like this:</p>
      <figure class="example" lang="ja">
        <p>ruby { ruby-position: over; }<br>
        rtc { ruby-position: under; } </p>
     <div class="demolink"><a href="styling-data/eg_dbl_mono" target="text">See live demo.</a></div>
     </figure>
      <p>If you use nested markup, and you have markup such as the following:</p>
      <figure class="example" lang="ja">
        <p>&lt;ruby&gt;&lt;ruby&gt;東&lt;rt&gt;とう&lt;/ruby&gt;&lt;rt&gt;tou&lt;rb&gt;&lt;ruby&gt;南&lt;rt&gt;なん&lt;/ruby&gt;&lt;rt&gt;nan&lt;/ruby&gt;の方角</p>
      </figure>
      <p>you could use CSS like this:</p>
      <figure class="example" lang="ja">
        <p>ruby { ruby-position: under; }<br>
          ruby  ruby { ruby-position: over; }
        </p>
    <div class="demolink"><a href="styling-data/eg_dbl_mono_nested" target="text">See live demo.</a></div>
      </figure>
	</section>
    </section>
    
    <section>
    <h2 id="inline_position"><a href="#inline_position">Rendering ruby text inline</a></h2>
    <p>In some situations you may want the annotations to appear inline, after the base text. For example, the <a href="markup">Ruby markup</a> article describes how complicated kanji characters with ruby on top can create accessibility issues. In other cases you may want to do this because the user interface is too small for ruby text to be legible, or because you want to repurpose the content for another type of application, etc.</p>
    <p>When both base text and annotation are side by side on the same line, it's important to be able to identify which is the annotation, and where it starts and ends. </p>
    <p>The chief issue with all these approaches is that there isn't one set of CSS rules that can be applied to all content. If your page mixes the <code class="kw" translate="no">rp</code>, interleaved, and tabular approaches, you'll need to use classes to indicate which set of CSS rules to apply to that particular ruby element.</p>
     <section>
    <h3 id="inline_rp"><a href="#inline_rp">Working with <code class="kw" translate="no">rp</code> markup</a></h3>
   <p>If you use <code class="kw" translate="no">rp</code> markup to specify what characters to use as delimiters and where to place them, you need to render the annotation inline and make the delimiters (which are invisible by default) visible.</p>
    <p>You could use this, which changes the <code class="kw" translate="no">display</code> value for the <code class="kw" translate="no">rt</code> elementand sets the font size to be the same as the base text (overriding the default size for the <code class="kw" translate="no">rt</code> element set by the browser).</p>
    <figure class="example" lang="ja">
      <p>rt { display: inline; font: inherit; }<br>
        rp { display: inline; }
      </p>
    </figure>
    <p>The rest of this section looks at how you can use CSS  if your content doesn't have <code class="kw" translate="no">rp</code> markup.</p>
     </section>
    <section>
    <h3 id="inline_interleaved"><a href="#inline_interleaved">Working with interleaved markup</a></h3>
    <p>If  you are quite happy for annotations to appear immediately after the base character(s) they are attached to, your content may be using the <a class="termref" href="markup#interleaved">interleaved</a> approach to ruby markup, and the expected outcome would be like this.</p>
    <figure>
    <p><img style="margin-right: 20%; vertical-align:top;" src="styling-data/inline_interleaved_hor.png" alt="Horizontal ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"><img src="styling-data/inline_interleaved_ver.png" alt="Vertical ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"></p>
      <!--p lang="zh-TW" style="float:left;margin-right: 5em;"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt>ㄋㄠˇ</rt></ruby></p>
      <p lang="zh-TW"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt style="font-size:30%;">ㄋㄠˇ</rt></ruby></p-->
   </figure>
    <p>In addition to making the <code class="kw" translate="no">rt</code> content display appropriately inline (as mentioned earlier), you will also need to surround each annotation with something, to set it off from the base text. Here we use the <code class="kw" translate="no">before</code> and <code class="kw" translate="no">after</code> pseudo-elements to surround it with parentheses.</p>


<div class="annotatedCode">
<div class="acFigure">
   <figure class="example" lang="ja">
      <p>rt { display: inline; font: inherit; }<br>
        rt::before { content: '（'; }<br>
        rt::after { content: '）'; }
      </p>
    <div class="demolink"><a href="styling-data/eg_inline" target="text">See live demo.</a></div>
  </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
</aside>
</div>
</div>
 </section>
  
    <section>
    <h3 id="inline_tabular"><a href="#inline_tabular">Working with tabular markup</a></h3>
   <p>If you want all the annotations for a given word to follow that word, grouped together as shown here, your content will use the <a class="termref" href="markup#tabular">tabular</a> markup approach.</p>
   <figure>
     <p><img style="margin-right: 30%; vertical-align:top;" src="styling-data/inline_tabular_hor.png" alt="Horizontal ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"><img src="styling-data/inline_tabular_ver.png" alt="Vertical ruby for 電(ㄉㄧㄢˋ)腦(ㄋㄠˇ)"></p>
     <!--p lang="zh-TW" style="float:left;margin-right: 5em;"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt>ㄋㄠˇ</rt></ruby></p>
      <p lang="zh-TW"><ruby><rb>電</rb><rt>ㄉㄧㄢˋ</rt><rb>腦</rb><rt style="font-size:30%;">ㄋㄠˇ</rt></ruby></p-->
   </figure>
   <p>Producing inline annotations in this case is a little more complicated if you're not using <code class="kw" translate="no">rp</code> markup.</p>


<div class="annotatedCode">
<div class="acFigure">
   <figure class="example" lang="ja">
      <p>rt { display: inline; font: inherit; }<br>
        <br>
/* Parens around &lt;rtc&gt; */ <br>
rtc::before { content: &quot;（&quot;; } rtc::after  { content: &quot;）&quot;; } <br>
<br>
/* Parens before first &lt;rt&gt; not inside &lt;rtc&gt; */ <br>
rb  + rt::before, rtc + rt::before { content: &quot;（&quot;; } <br>
<br>
/* Parens after &lt;rt&gt; not inside &lt;rtc&gt; */<br>
rb ~ rt:last-child::after, rt + rb::before  { content: &quot;）&quot;; } <br>
rt + rtc::before { content: &quot;）（&quot;; }</p>
    <div class="demolink"><a href="styling-data/eg_inline_tabular" target="text">See live demo.</a></div>
  </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
</aside>
</div>
</div>




    </section>
</section>

<section>
  <h2 id="alignment"><a href="#alignment">Aligning annotations and bases</a></h2>
  <div class="sidenoteGroup">
  <p>When the ruby text annotation is longer than the ruby base it belongs to, or vice-versa, there can be several different ways of dealing with the extra space that is lying around. The CSS Ruby spec deals with this mostly through the use of the <code class="kw" translate="no">ruby-align</code> property.</p>
  <aside class="sideinfonote">
    <p class="info">The examples in this section are slightly unusual in that they use group ruby and distort pinyin annotations in ways you might not normally, but which clearly illustrate the point being made. We also add red lines to help clarify positioning.</p>
  </aside> 
  </div>
  <p>It's best to use this property on the <code class="kw" translate="no">ruby</code> element.</p>
  <p>If you are working with inter-character bopomofo ruby, none of this  is relevant, since the positioning of the bopomofo characters and tone marks is fixed.</p>
  
  <section>
    <h3 id="aligning_ends"><a href="#aligning_ends">Aligning to one edge</a></h3>
  <!--div class="sidenoteGroup"-->
    <figure>
      <p><img src="styling-data/ruby-align-start.png" alt="Picture of start-aligned text."/></p>
    </figure>
    <!--p><ruby><rb>浮世絵</rb><rt>うきよえ</rt></ruby><ruby><rb>昔話</rb><rt>むかしばなし</rt></ruby></p-->
  <!--aside class="implnote">
  <p class="impl">Works as specified in Firefox. In Edge it only works if you use the value <code class="kw" translate="no">left</code>. Doesn't work in Chrome or Safari.<br>
    <a href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_align_start">See test results for major browsers</a>.</p>
</aside>
</div-->
    
    <p>If you want to align the edges of the annotation and the base, you can use the <code class="kw" translate="no">start</code> value of <code class="kw" translate="no">ruby-align</code>. (An older version of the Ruby CSS spec also included an <code class="kw" translate="no">end</code> value, but that has been removed from the current version.)</p>
    
  <div class="annotatedCode">
  <div class="acFigure">
    <figure class="example" lang="ja">
      <p>ruby { ruby-align: start; }</p>
      <div class="demolink"><a target="_blank" href="styling-data/eg_ruby_align_start">See live demo.</a></div>
      </figure>
  </div>
  <div class="acNote">
    <aside class="insideimplnote">
      <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> If there is a <code class="kw" translate="no">lang</code> attribute indicating that the content is Chinese (<code class="kw" translate="no">zh</code>...) then shorter text is centered. Otherwise, it acts as expected.<br>
        <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> only works if you use the value <code class="kw" translate="no">left</code>.<br>
        <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/><br>
        <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_align_start">See test results for major browsers</a>.</p>
  </aside>
  </div>
  </div>
    
</section>
  
  <section>
  <h3 id="aligning_centered"><a href="#aligning_centered">Centering shorter items of text</a></h3>
  <figure>
    <p><img src="styling-data/ruby-align-center.png" alt="Picture of start-aligned text."/></p>
  </figure>
  <p>If you want the shorter of the ruby base or ruby text to be centered, with the characters set solid, rather than aligned with an edge, it will hardly be a surprise to learn that you just need to set the value of <code class="kw" translate="no">ruby-align</code> to <code class="kw" translate="no">center</code>.</p>
  <div class="annotatedCode">
    <div class="acFigure">
  <figure class="example" lang="ja">
    <p>ruby { ruby-align: center; }</p>
    <div class="demolink"><a href="styling-data/eg_ruby_align_center" target="_blank">See live demo.</a></div>
  </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/><br>
    <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/><br>
    <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_align_center">See test results for major browsers</a>.</p>
</aside>
</div>
</div>
</section>
  
  <section>
  <h3 id="aligning_justified"><a href="#aligning_justified">Applying justification to shorter items of text</a></h3>
  <p>If you want to use up redundant space by stretching the shorter text, be it the annotation or the base,  you have two choices: you can justify the shorter text from edge to edge of the longer one (<code class="kw" translate="no">space-between</code>), or justify across a space that is slightly smaller than the full width available (<code class="kw" translate="no">space-around</code>).</p>
  <p>Note, however, that the justification outcome differs according to what scripts are involved. </p>
<h4>Justifying East Asian characters</h4>
<p>Let's look first at what happens if the characters in your ruby annotation are Han characters and kana characters. This is  likely to be the case for Japanese ruby.</p>
  <p>To widen the shorter text to exactly the same width as the longer text, stretching the inter-character spaces equally, use the <code class="kw" translate="no">space-between</code> value of <code class="kw" translate="no">ruby-align</code>.</p>
  <figure>
  <p><img src="styling-data/ruby-align-between.png" alt="Picture of start-aligned text."/><!--p><ruby><rb>浮世絵</rb><rt>うきよえ</rt></ruby><ruby><rb>昔話</rb><rt>むかしばなし</rt></ruby></p-->  </p>
  </figure>

 <div class="annotatedCode">
   <div class="acFigure">
  <figure class="example" lang="ja">
    <p>ruby { ruby-align: space-between; }</p>
    <div class="demolink"><a href="styling-data/eg_ruby_align_space_between" target="_blank">See live demo.</a></div>
  </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> If there is a <code class="kw" translate="no">lang</code> attribute indicating that the content is Chinese (<code class="kw" translate="no">zh</code>...) then ruby text is just centered and set solid. Otherwise, it acts as expected for east asian characters.<br>
    <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> only works if you use the proprietary <code class="kw" translate="no">distribute-letter</code> value.<br>
    <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/><br>
    <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_align_space_between">See test results for major browsers</a>.</p>
</aside>
</div>
</div>

<p>Or you can stretch the text in the same way, but not quite so far, leaving half a character width of space on either side, as shown here. For this you use the <code class="kw" translate="no">space-around</code> value.</p>
  <figure>
    <p><img src="styling-data/ruby-align-around.png" alt="Picture of start-aligned text."/></p>
  <!--p><ruby><rb>浮世絵</rb><rt>うきよえ</rt></ruby><ruby><rb>昔話</rb><rt>むかしばなし</rt></ruby></p-->
  </figure>

 <div class="annotatedCode">
   <div class="acFigure">
  <figure class="example" lang="ja">
    <p>ruby { ruby-align: space-around; }</p>
    <div class="demolink"><a href="styling-data/eg_ruby_align_space_around" target="_blank">See live demo.</a></div>
  </figure>
</div>
<div class="acNote">
  <aside class="insideimplnote">
  <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> If there is a <code class="kw" translate="no">lang</code> attribute indicating that the content is Chinese (<code class="kw" translate="no">zh</code>...) then ruby text is centered and set solid. Otherwise, it acts as expected for east asian characters.<br> 
    <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/><img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/><br>
    Works for east asian characters as specified  since this is the browser default<br>
    <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_align_space_around">See test results for major browsers</a>.</p>
  </aside>
</div>
</div>
 <h4>Justifying other characters</h4>
  <p>Here we look at what to expect if either the base or the annotation uses a script such as Latin  for pinyin. For Chinese ruby that doesn't use bopomofo, this is the most likely case.</p>
  <p>We are still working with the <code class="kw" translate="no">space-between</code> and <code class="kw" translate="no">space-around</code> values of the <code class="kw" translate="no">ruby-align</code> property, and they still affect whether the text is justified to the edge of the longer text or not. But the result varies according to whether or not the justified text contains spaces.</p>
  <p>If a single word is used, you should expect it to be centered, as shown below on the left. </p>
  <p>If there are spaces in the shorter text, then it will be justified in the normal way for that script, ie. you can expect to see inter-word spacing for Latin text.</p>
    <!--p lang="zh-hans"><ruby><rb>頤和園</rb><rt>yíhéyuán</rt></ruby><ruby><rb>頤和園</rb><rt>yí hé yuán</rt></ruby></p-->
    <div class="annotatedCode">
      <div class="acFigure">
        <figure>
  		<p><img src="styling-data/summer-palace.png" alt="Picture of start-aligned text."/></p>
          <div class="demolink"><a href="styling-data/eg_ruby_align_space_around_latin" target="_blank">See live demo.</a></div>
        </figure>
      </div>
      <div class="acNote">
        <aside class="insideimplnote">
          <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> if there is a <code class="kw" translate="no">lang</code> attribute indicating that the content is Chinese (<code class="kw" translate="no">zh</code>...) then ruby text is just centered and set solid. Otherwise, it acts as shown in the diagram.<br>
            <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> words are stretched to fit, with inter-character spacing, just like asian characters, rather than the standard inter-word justification you get in Firefox.
            </p>
          <p> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/>  both browsers still fail to support <code class="kw" translate="no">space-between</code>, but handle the latin text as shown in the diagram.<br>
            <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_align_space_around">See test results for major browsers</a>.</p>
        </aside>
      </div>
    </div>
<p>There is no difference in styling for the two examples above – we simple removed the spaces from the pinyin on the left.</p>
  </section>
  
    
  <section>
    <h3 id="aligning_defaults"><a href="#aligning_ends">The default alignment in browsers</a></h3>
    
    <p>The CSS specification contains a default style sheet for browsers, which says that if your content is Chinese – more specifically, if you have set the <code class="kw" translate="no">lang</code> attribute to something beginning with <code class="kw" translate="no">zh</code> – then the default behaviour will be that of <code class="kw" translate="no">ruby-align:center</code>. Otherwise, the default behaviour is the same as <code class="kw" translate="no">ruby-align:space-around</code>.</p>
    <p>Note that the latter behaviour is the default if you label your Chinese content as <abbr title="Mandarin Chinese"><code class="kw" translate="no">cmn</code></abbr> or <abbr title="Cantonese/Yue chinese"><code class="kw" translate="no">yue</code></abbr>. Only the generic <code class="kw" translate="no">zh</code>... label produces the automatic centering.</p>
  </section>
</section>


<section>
<h2 id="gaps"><a href="#gaps">Handling gaps in annotations</a></h2>
<p>You may want to attach ruby annotations to a word such as 振り仮名 (furigana) without adding the redundant り. </p>
<figure>
  <p><img style="margin-right: 30%; vertical-align:top;" src="styling-data/autohide_hor.png" alt="Horizontal ruby for 振り仮名（ふりがな）"><img src="styling-data/autohide_ver.png" alt="Vertical ruby for 振り仮名（ふりがな）"></p>
</figure>
<p>One way to achieve this would be to simply leave a blank <code class="kw" translate="no">rt</code> element, like this:</p>
<div class="annotatedCode">
  <div class="acFigure">
    <figure class="example" lang="ja">
      <p>&lt;ruby&gt;&lt;rb&gt;振&lt;rb&gt;り&lt;rb&gt;仮&lt;rb&gt;名&lt;rt&gt;ふ&lt;rt&gt;&lt;rt&gt;が&lt;rt&gt;な&lt;/rt&gt;&lt;/ruby&gt;</p>
      <div class="demolink"><a href="styling-data/eg_autohide_defective" target="_blank">See live demo.</a></div>
    </figure>
  </div>
  <div class="acNote">
    <aside class="insideimplnote">
      <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/><img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    </aside>
  </div>
</div>
<p>This would pose a problem, however, if you wanted to display the annotation inline: instead of <span lang="ja">振り仮名（ふりがな）</span> you would see 振り仮名（ふがな）. It can also present problems if you want to merge ruby annotations across a compound noun (something which may be introduced later).</p>
<p>The CSS spec proposes a solution for this. If the base text and corresponding annotation are identical, browsers should not show the annotation unless it is part of an inline sequence. So you could use the following code to produce this effect, without any special styling, if the browser supports it.</p>
<div class="annotatedCode">
  <div class="acFigure">
    <figure class="example" lang="ja">
      <p>&lt;ruby&gt;&lt;rb&gt;振&lt;rb&gt;り&lt;rb&gt;仮&lt;rb&gt;名&lt;rt&gt;ふ&lt;rt&gt;り&lt;rt&gt;が&lt;rt&gt;な&lt;/rt&gt;&lt;/ruby&gt;</p>
      <div class="demolink"><a href="styling-data/eg_autohide" target="_blank">See live demo.</a></div>
    </figure>
  </div>
  <div class="acNote">
    <aside class="insideimplnote">
      <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/><br>
        <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/><img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/><br>
        <a target="_blank" href="https://www.w3.org/International/tests/repo/results/css-ruby#ruby_autohide">See test results for major browsers</a></p>
    </aside>
  </div>
</div>
<p>&nbsp;</p>
</section>



<section>
<h2 class="notoc" id="todo"><a href="#todo">To do</a></h2>
<ul>
  <li>Link it to overhang (which gives more room by overlapping adjacent bases)</li>
  <li>Figure out what to do about ruby-merge – present as managing compound nouns, ie. managing the space within adjacent ruby pairs?</li>
  <li>section on styling base text, including removal, replacement with boxes (for educational text), etc.</li>
  <li>clarify <a  href="https://drafts.csswg.org/css-ruby-1/#white-space">space handling</a> - do this in ruby markup article too</li>
  <li>setting line height</li>
  <li>making line head and end flush</li>
</ul>
</section>

<section>
  <h2 id="endlinks"><a href="#endlinks">Further reading</a></h2>
<aside class="section" id="survey"> </aside><script>document.getElementById('survey').innerHTML = g.survey</script>

  <ul id="full-links">
    <li>
      <p><a href="index">What is ruby?</a></p>
    </li>
    <li>
      <p>Related links, <cite>Authoring HTML &amp; CSS</cite></p>
      <ul>
        <li><a href="https://www.w3.org/International/techniques/authoring-html#ruby">Using ruby markup</a></li>
        <li><a href="https://www.w3.org/International/techniques/authoring-html#rubystyle">Styling ruby text</a></li>
      </ul>
    </li>
  </ul>
</section>

<footer id="thefooter"></footer><script type="text/javascript">document.getElementById('thefooter').innerHTML = g.bottomOfPage</script>
<script type="text/javascript">completePage(); //highlightCode();
</script>
</body>
</html>
